#!/bin/bash -e
# shellcheck source=lib/all.bash
. "${taito_plugin_path:?}/lib/all.bash"
# shellcheck source=../kubectl/lib/context.bash
. "${taito_plugin_path:?}/../kubectl/lib/context.bash"

name="${1}"

if taito::confirm_execution "helm" "${name}" \
  "Delete and purge helm release ${taito_project}-${taito_target_env}"
then
  kubectl::use-context
  (
    ${taito_setv:?}
    helm::run delete --purge "${taito_project}-${taito_target_env}"
  ) || echo "WARNING: Deleting helm release failed. Have you ever deployed?"
fi

taito::call_next "${@}"
