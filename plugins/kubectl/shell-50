#!/bin/bash -e
: "${taito_plugin_path:?}"
: "${taito_namespace:?}"
: "${taito_project:?}"

# TODO: do is-target-type check elsewhere also
if taito::is_current_target_of_type container; then
  "${taito_plugin_path}/util/use-context"

  . "${taito_plugin_path}/util/determine-pod-container"
  (${taito_setv:?}; kubectl exec -it "${pod}" -c "${container}" -- "/bin/sh") || \
  (${taito_setv:?}; kubectl exec -it "${pod}" -- "/bin/sh")
fi

taito::call_next "${@}"
