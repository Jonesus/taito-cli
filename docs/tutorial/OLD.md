
> You can skip this step if your organization already provides a suitable infrastructure for this tutorial. However, you might still like to browse through [Appendix C](c-modern-server-infrastructure.md) to famirialize yourself with basic concepts of modern server infrastructure.

Taito-cli is designed to be infrastructure agnostic. That is, the same taito-cli commands can be used in any project no matter the technology or infrastructure. These exercises, however, are based on [kubernetes-template](https://github.com/TaitoUnited/server-template) that requires Kubernetes, PostgreSQL, a S3 compatible storage bucket, and a kubernetes-template compatible CI/CD pipeline. If you don't have an existing infrastructure that provides these already, you can easily set them up by creating a new **taito zone** based on one of the [infrastructure templates](https://github.com/TaitoUnited/taito-cli/blob/dev/docs/templates.md#infrastructure-templates):

1. Create a Google Cloud account.

2. Create a billing account on Google Cloud.

3. Install taito-cli.

## Create a taito zone in Google Cloud

TODO OPTIONAL: first setup remote state for terraform

1. Configure `taito_zone` and `gcloud_org_id` in the `zone-gcloud/taito-config.sh` file. (TODO configure all places that say...) (TODO installing without organization?)

2. Authenticate by running `taito --auth` in the `zone-gcloud` directory.

3. Create taito zone by running `taito zone apply` in the `zone-gcloud` directory.

4. TODO change postgres user password afterwards or provide it with google_sql_user? tfstate contains some generated passwords and certificates that should be protected anyway! --> TODO: Add note that no need to commit if you don't want to manage state with terraform.

TODO: LoadBalancer IP:
- check google load balancer IP and set DNS record: *.mydomain.com
- make IP permanent: VPC Network -> External IP Addresses -> Ephemeral>Static

TODO: CI/CD cannot pull taito-cli image from another zone -> use docker hub in all examples
TODO: Check TODOs of 'zone apply' command implementations.

The newly created zone includes:

* Kubernetes cluster for applications
* Postgres cluster for data
* Storage for serving static resources
* Container registry and builder for CI/CD
* Stackdriver for logging and monitoring
* Google Functions and pubsub for events/notifications

## Create a project and deploy it to the taito zone

1. Create a new project by running `taito project create: kubernetes-template` and follow instructions.

2. Run `taito project apply` in the project directory. TODO sentry

3. Create dev and prod environments for the project by running `taito env apply:dev` and `taito env apply:prod` in the project directory. This will TODO:

4. Start local development by running: `taito install`, `taito start`, `taito init` and `taito open client`.

5. Push a change in the dev branch and it will be deployed on your Kubernetes cluster running on Google Cloud as a development version. You can open it on browser by running `taito open client:dev`.

6. Merge the change in the master branch and it will be deployed on your Kubernetes cluster running on Google Cloud as a production version. You can open it on browser by running `taito open client:prod`.

Hooray! You are now running your app in production with all the bells and whistles like multiple environments, automatic deployments, deployment versioning and reversions, data migrations, autogenerated release notes, autogenerated ssl certificates, secret rotation, error tracking, uptime monitoring, log analytics, backups, autoscaling, and high availability. Nevertheless, almost anyone is able to operate it using the easy-to-use command set provided by the `taito-cli`. You can also easily move it to any cloud service provider, or alternatively host it on your own dedicated servers. And all the same taito-cli commands still work as they should.

> TODO CDN and performance monitoring.

## Running on some other infrastructure

Want to run software on some other infrastructure than Google Cloud and Kubernetes? Please contribute by developing taito-cli plugins for the infrastructure in question.

## Create a custom extension

TODO instructions

## Miscellaneous tips

See taito-cli commands by running `taito -h`.
